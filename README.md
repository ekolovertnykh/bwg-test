
# Тестовое задание для ООО "НьюЭраМедиа"

Задание:

1. Поднять 4 сервиса на Express

2. Написать балансировщик нагрузки. Балансировщик равномерно распрелдляет нагрузку на 4 сервиса

3. Балансировщик логирует входящие запросы и блокирует пользователей при лимите больше 100 RPS

4. Скрипт генерирующий запросы на балансировщик


## Технологии

В моей реализации балансировщик использует библиотеку http, нагрузка между сервисами 
распределяется с помощью алгоритма Least Connections. Запросы перенаправляются от балансировщика
к нужному сервису с помощью [http-proxy](https://www.npmjs.com/package/http-proxy)

Для подсчета пользовательского RPS я использовал Redis, 
конкретнее [SETNX](https://redis.io/commands/setnx/), 
[EXPIRE](https://redis.io/commands/expire/) и [DECR](https://redis.io/commands/decr/)  

Сервис, который обрабатывает запрос, представляет из себя hello world на Express

## Запуск

Сначала необходимо собрать образы

```bash
  chmod +x build.sh
  npm run docker:build
```

Далее, можно запускать контейнеры


```bash
  npm run docker:start
```

Выполняем загрузочный тест


```bash
  npm run bench
```
